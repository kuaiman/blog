{"Asset":[{"_id":"source\\CNAME","path":"CNAME","modified":true},{"_id":"source\\robots.txt","path":"robots.txt","modified":true},{"_id":"themes\\landscape-plus\\source\\img\\scrollup.png","path":"img/scrollup.png","modified":true},{"_id":"themes\\landscape-plus\\source\\js\\count.js","path":"js/count.js","modified":true},{"_id":"themes\\landscape-plus\\source\\js\\script.js","path":"js/script.js","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\bdshare.styl","path":"css/bdshare.styl","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\style.styl","path":"css/style.styl","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\FontAwesome.otf","path":"css/fonts/FontAwesome.otf","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.eot","path":"css/fonts/fontawesome-webfont.eot","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.svg","path":"css/fonts/fontawesome-webfont.svg","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.ttf","path":"css/fonts/fontawesome-webfont.ttf","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.woff","path":"css/fonts/fontawesome-webfont.woff","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\images\\banner.jpg","path":"css/images/banner.jpg","modified":true},{"_id":"themes\\landscape-plus\\source\\css\\images\\bannerbk.jpg","path":"css/images/bannerbk.jpg","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\blank.gif","path":"fancybox/blank.gif","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_loading.gif","path":"fancybox/fancybox_loading.gif","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_loading@2x.gif","path":"fancybox/fancybox_loading@2x.gif","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_overlay.png","path":"fancybox/fancybox_overlay.png","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_sprite.png","path":"fancybox/fancybox_sprite.png","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_sprite@2x.png","path":"fancybox/fancybox_sprite@2x.png","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.css","path":"fancybox/jquery.fancybox.css","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.js","path":"fancybox/jquery.fancybox.js","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.pack.js","path":"fancybox/jquery.fancybox.pack.js","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\fancybox_buttons.png","path":"fancybox/helpers/fancybox_buttons.png","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-buttons.css","path":"fancybox/helpers/jquery.fancybox-buttons.css","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-buttons.js","path":"fancybox/helpers/jquery.fancybox-buttons.js","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-media.js","path":"fancybox/helpers/jquery.fancybox-media.js","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.css","path":"fancybox/helpers/jquery.fancybox-thumbs.css","modified":true},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.js","path":"fancybox/helpers/jquery.fancybox-thumbs.js","modified":true}],"Cache":[{"_id":"scaffolds\\draft.md","mtime":1424141233564},{"_id":"scaffolds\\page.md","mtime":1424141233562},{"_id":"scaffolds\\post.md","mtime":1424141233564},{"_id":"scaffolds\\photo.md","mtime":1424141233568},{"_id":"source\\CNAME","mtime":1425275115779},{"_id":"source\\robots.txt","mtime":1425359929938},{"_id":"source\\About\\index.md","mtime":1424913501146},{"_id":"source\\_posts\\realtime-count-firebase.md","mtime":1425562446374},{"_id":"source\\_posts\\第一篇blog.md","mtime":1425342392794},{"_id":"themes\\landscape-plus\\LICENSE","mtime":1424913501295},{"_id":"themes\\landscape-plus\\Gruntfile.js","mtime":1424913501261},{"_id":"themes\\landscape-plus\\README.md","mtime":1424913501302},{"_id":"themes\\landscape-plus\\_config.yml","mtime":1425019926441},{"_id":"themes\\landscape-plus\\package.json","mtime":1424913501837},{"_id":"themes\\landscape-plus\\languages\\default.yml","mtime":1424913501312},{"_id":"themes\\landscape-plus\\languages\\zh-CN.yml","mtime":1424913501318},{"_id":"themes\\landscape-plus\\languages\\zh-TW.yml","mtime":1424913501324},{"_id":"themes\\landscape-plus\\scripts\\fancybox.js","mtime":1424913501842},{"_id":"themes\\landscape-plus\\layout\\archive.ejs","mtime":1424913501709},{"_id":"themes\\landscape-plus\\layout\\category.ejs","mtime":1424913501712},{"_id":"themes\\landscape-plus\\layout\\index.ejs","mtime":1424913501731},{"_id":"themes\\landscape-plus\\layout\\layout.ejs","mtime":1424913501763},{"_id":"themes\\landscape-plus\\layout\\page.ejs","mtime":1424913501801},{"_id":"themes\\landscape-plus\\layout\\post.ejs","mtime":1424913501802},{"_id":"themes\\landscape-plus\\layout\\tag.ejs","mtime":1424913501835},{"_id":"themes\\landscape-plus\\layout\\_widget\\archive.ejs","mtime":1424913501690},{"_id":"themes\\landscape-plus\\layout\\_widget\\category.ejs","mtime":1424913501692},{"_id":"themes\\landscape-plus\\layout\\_widget\\links.ejs","mtime":1424913501694},{"_id":"themes\\landscape-plus\\layout\\_widget\\recent_posts.ejs","mtime":1424913501698},{"_id":"themes\\landscape-plus\\layout\\_widget\\tag.ejs","mtime":1424913501700},{"_id":"themes\\landscape-plus\\layout\\_widget\\tagcloud.ejs","mtime":1424913501703},{"_id":"themes\\landscape-plus\\layout\\_widget\\weibo.ejs","mtime":1424913501705},{"_id":"themes\\landscape-plus\\layout\\_partial\\after-footer.ejs","mtime":1424913501425},{"_id":"themes\\landscape-plus\\layout\\_partial\\archive-post.ejs","mtime":1424913501430},{"_id":"themes\\landscape-plus\\layout\\_partial\\archive.ejs","mtime":1424913501439},{"_id":"themes\\landscape-plus\\layout\\_partial\\article.ejs","mtime":1424913501447},{"_id":"themes\\landscape-plus\\layout\\_partial\\baidu_tongji.ejs","mtime":1425342392800},{"_id":"themes\\landscape-plus\\layout\\_partial\\footer.ejs","mtime":1425109669528},{"_id":"themes\\landscape-plus\\layout\\_partial\\google-analytics.ejs","mtime":1424913501609},{"_id":"themes\\landscape-plus\\layout\\_partial\\head.ejs","mtime":1425342392807},{"_id":"themes\\landscape-plus\\layout\\_partial\\header.ejs","mtime":1424913501617},{"_id":"themes\\landscape-plus\\layout\\_partial\\mathjax.ejs","mtime":1424913501634},{"_id":"themes\\landscape-plus\\layout\\_partial\\mobile-nav.ejs","mtime":1424913501639},{"_id":"themes\\landscape-plus\\layout\\_partial\\sidebar.ejs","mtime":1424913501685},{"_id":"themes\\landscape-plus\\layout\\_partial\\totop.ejs","mtime":1424913501688},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\category.ejs","mtime":1424913501645},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\date.ejs","mtime":1424913501658},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\gallery.ejs","mtime":1424913501668},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\nav.ejs","mtime":1424913501670},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\tag.ejs","mtime":1424913501676},{"_id":"themes\\landscape-plus\\layout\\_partial\\post\\title.ejs","mtime":1424913501680},{"_id":"themes\\landscape-plus\\source\\img\\scrollup.png","mtime":1424913502743},{"_id":"themes\\landscape-plus\\source\\js\\count.js","mtime":1425110005024},{"_id":"themes\\landscape-plus\\source\\js\\script.js","mtime":1424913502794},{"_id":"themes\\landscape-plus\\source\\css\\_extend.styl","mtime":1424913501846},{"_id":"themes\\landscape-plus\\source\\css\\_variables.styl","mtime":1424913502056},{"_id":"themes\\landscape-plus\\source\\css\\bdshare.styl","mtime":1424913502064},{"_id":"themes\\landscape-plus\\source\\css\\style.styl","mtime":1424913502389},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\archive.styl","mtime":1424913501848},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\article.styl","mtime":1424913501852},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\comment.styl","mtime":1424913501858},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\footer.styl","mtime":1424913501862},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\header.styl","mtime":1424913501899},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\highlight.styl","mtime":1425447029597},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\mobile.styl","mtime":1424913501957},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\sidebar-aside.styl","mtime":1424913501963},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\sidebar.styl","mtime":1424913501987},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\sidebar-bottom.styl","mtime":1424913501971},{"_id":"themes\\landscape-plus\\source\\css\\_partial\\totop.styl","mtime":1424913501993},{"_id":"themes\\landscape-plus\\source\\css\\_util\\grid.styl","mtime":1424913502021},{"_id":"themes\\landscape-plus\\source\\css\\_util\\mixin.styl","mtime":1424913502051},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\FontAwesome.otf","mtime":1424913502072},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.eot","mtime":1424913502175},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.svg","mtime":1424913502192},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.ttf","mtime":1424913502219},{"_id":"themes\\landscape-plus\\source\\css\\fonts\\fontawesome-webfont.woff","mtime":1424913502223},{"_id":"themes\\landscape-plus\\source\\css\\images\\banner.jpg","mtime":1424913502245},{"_id":"themes\\landscape-plus\\source\\css\\images\\bannerbk.jpg","mtime":1424913502385},{"_id":"themes\\landscape-plus\\source\\fancybox\\blank.gif","mtime":1424913502436},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_loading.gif","mtime":1424913502442},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_loading@2x.gif","mtime":1424913502449},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_overlay.png","mtime":1424913502455},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_sprite.png","mtime":1424913502462},{"_id":"themes\\landscape-plus\\source\\fancybox\\fancybox_sprite@2x.png","mtime":1424913502508},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.css","mtime":1424913502655},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.js","mtime":1424913502678},{"_id":"themes\\landscape-plus\\source\\fancybox\\jquery.fancybox.pack.js","mtime":1424913502692},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\fancybox_buttons.png","mtime":1424913502514},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-buttons.css","mtime":1424913502524},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-buttons.js","mtime":1424913502574},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-media.js","mtime":1424913502590},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.css","mtime":1424913502597},{"_id":"themes\\landscape-plus\\source\\fancybox\\helpers\\jquery.fancybox-thumbs.js","mtime":1424913502642}],"Category":[],"Page":[{"title":"About","date":1424509293000,"content":"<h2 id=\"个人信息\">个人信息</h2>\n<p>庞健 pangjian</p>\n<p>毕业于北京理工大学计算机学院</p>\n<p>现在的职业是金融IT</p>\n<h2 id=\"联系方式\">联系方式</h2>\n<p>邮箱：<a href=\"&#x6d;&#x61;&#x69;&#x6c;&#x74;&#x6f;&#58;&#112;&#x61;&#x6e;&#103;&#106;&#105;&#97;&#x6e;&#49;&#48;&#49;&#48;&#64;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#111;&#109;\">&#112;&#x61;&#x6e;&#103;&#106;&#105;&#97;&#x6e;&#49;&#48;&#49;&#48;&#64;&#x67;&#109;&#97;&#105;&#x6c;&#x2e;&#99;&#111;&#109;</a><br>电话：186 ^_^</p>\n<h2 id=\"其他\">其他</h2>\n","source":"About/index.md","raw":"title: About\ndate: 2015-02-21 17:01:33\n---\n\n##个人信息\n庞健 pangjian\n\n毕业于北京理工大学计算机学院\n\n现在的职业是金融IT\n\n##联系方式\n\n邮箱：<pangjian1010@gmail.com>\n电话：186 ^_^\n\n##其他\n","updated":1424913501146,"path":"About/index.html","excerpt":"","_id":"yt3vxdub15rypebw","comments":true,"layout":"page"}],"Post":[{"title":"基于Firebase的Hexo博客实时访问数统计","date":1425021126000,"tags":["hv06o0yl1bam5qcp","cf916ew7c6afg12c","55a0ailcrihn5x6s"],"photos":["http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/firebase.PNG"],"content":"<p>本来想写一个HEXO的搭建过程的，但是在搜索引擎上一搜一大把教程。看到有人评论：“你写这个跟HEXO官方的教程比好在哪？”仔细想想，说的极好。索性也就不写这个人家已经写烂了的东西了。附一个<a href=\"http://hexo.io/docs/\" target=\"_blank\" rel=\"external\">官方教程链接</a>。其实在搭建过程中还参考了一个很全面很详细的博客，也附上链接吧，<a href=\"http://ibruce.info/2013/11/22/hexo-your-blog/\" target=\"_blank\" rel=\"external\">ibruce不如</a>。<br>对于像HEXO这种静态博客来讲，想要做到一些动态的功能就必须得靠第三方支持，比如评论可以使用多说、Disqus。虽然我的blog的访问人数少的可怜，但是我还是希望知道有多少访问量的。于是乎发现了FireBase这个神奇的东西，它是一个制作实时应用的框架，用它来统计访问量绰绰有余啦。它可以做到的就像本博客下面的一样，你可以尝试开启两个本博客窗口，然后刷新其中一个，看看另外一个页面，是不是很神奇？另一个页面的访问量也实时增加了！</p>\n<a id=\"more\"></a>\n<h2 id=\"注册Firebase账号\">注册Firebase账号</h2>\n<p>在<a href=\"www.firebase.com\">Firebase官网</a>注册一个新用户<br><img src=\"http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/signup.PNG\" alt=\"Sign Up\"></p>\n<h2 id=\"创建应用\">创建应用</h2>\n<p>注册成功以后就可以创建一个应用了<br><img src=\"http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/createApp.PNG\" alt=\"create app\"></p>\n<h2 id=\"Firebase基本用法\">Firebase基本用法</h2>\n<p>Firebase使用JSON存储数据，但是Firebase不支持Arrays数组，它会将数组转换成一个Object对象来存储，就像这样。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">[<span class=\"string\">'a'</span>, <span class=\"string\">'b'</span>, <span class=\"string\">'c'</span>, <span class=\"string\">'d'</span>, <span class=\"string\">'e'</span>]</div></pre></td></tr></table></figure>\n\n<p>会被转换成这样存储</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\">{<span class=\"number\">0</span>: <span class=\"string\">'a'</span>, <span class=\"number\">1</span>: <span class=\"string\">'b'</span>, <span class=\"number\">2</span>: <span class=\"string\">'c'</span>, <span class=\"number\">3</span>: <span class=\"string\">'d'</span>, <span class=\"number\">4</span>: <span class=\"string\">'e'</span>}</div></pre></td></tr></table></figure>\n\n<h3 id=\"存储数据\">存储数据</h3>\n<h4 id=\"set()\"><code>set()</code></h4>\n<p><code>set()</code>方法调用若原先没有值则会新增，若原先有值，会覆盖原有的结构替换成这次的内容包括子节点！</p>\n<h4 id=\"update()\"><code>update()</code></h4>\n<p><code>update()</code>可以更新一个已经存在的值，并且不会覆盖其他内容。</p>\n<h4 id=\"transaction()\"><code>transaction()</code></h4>\n<p><code>transaction()</code>就是本文用来统计访问量的方法。支持在原有值得基础上进行修改，它的参数是一个回调函数，用来处理原有的值使其变成新的值。下面是官方给的例子，就是用来统计访问量的。</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> upvotesRef = <span class=\"keyword\">new</span> Firebase(<span class=\"string\">'https://docs-examples.firebaseio.com/android/saving-data/fireblog/posts/-JRHTHaIs-jNPLXOQivY/upvotes'</span>);</div><div class=\"line\">upvotesRef.transaction(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">(current_value)</span> </span>{</div><div class=\"line\">  <span class=\"keyword\">return</span> (current_value || <span class=\"number\">0</span>) + <span class=\"number\">1</span>;</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<h3 id=\"读取数据\">读取数据</h3>\n<p>firebase可以绑定比如<code>child_added</code>、<code>Child Removed</code>、<code>value</code>等事件，每当有子元素添加或者值变化时会触发绑定的回调函数。具体调用方法可以参考本文后面提到的方法。</p>\n<h2 id=\"在你的HEXO页面上引入Firebase\">在你的HEXO页面上引入Firebase</h2>\n<p>在页面的head中引入Firebase的js，</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">script</span> <span class=\"attribute\">src</span>=<span class=\"value\">'https://cdn.firebase.com/js/client/2.0.4/firebase.js'</span>&gt;</span><span class=\"javascript\"></span><span class=\"tag\">&lt;/<span class=\"title\">script</span>&gt;</span></div></pre></td></tr></table></figure>\n\n<p>为了加速，也可以将这个js放到自己的七牛云存储上。</p>\n<h2 id=\"增加代码调用Firebase来实现记录访问数\">增加代码调用Firebase来实现记录访问数</h2>\n<h3 id=\"思路：\">思路：</h3>\n<p>1.总共记录两类访问记录，一个总数，一个该页面数<br>2.该页面数使用该页面的url作为key值<br>3.每次访问一个页面时，总数+1，本页面数+1<br>4.同时增加记录最后更新时间，和最后更新的那个页面的url</p>\n<h3 id=\"过程：\">过程：</h3>\n<p>先修改页面的footer用来展示访问记录数，就像这样。当然你可以加在页面的任意位置。</p>\n<figure class=\"highlight html\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"tag\">&lt;<span class=\"title\">footer</span> <span class=\"attribute\">id</span>=<span class=\"value\">\"footer\"</span>&gt;</span></div><div class=\"line\">  <span class=\"vbscript\">&lt;% <span class=\"keyword\">if</span> (theme.sidebar === <span class=\"comment\">'bottom'){ %&gt;</span></span></div><div class=\"line\">    <span class=\"vbscript\">&lt;%- partial(<span class=\"comment\">'_partial/sidebar') %&gt;</span></span></div><div class=\"line\">  <span class=\"vbscript\">&lt;% } %&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;<span class=\"title\">div</span> <span class=\"attribute\">class</span>=<span class=\"value\">\"outer\"</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;<span class=\"title\">div</span> <span class=\"attribute\">id</span>=<span class=\"value\">\"footer-info\"</span> <span class=\"attribute\">class</span>=<span class=\"value\">\"inner\"</span>&gt;</span></div><div class=\"line\">      &copy; <span class=\"vbscript\">&lt;%= <span class=\"built_in\">date</span>(<span class=\"keyword\">new</span> <span class=\"built_in\">Date</span>(), <span class=\"comment\">'YYYY') %&gt;</span></span> <span class=\"vbscript\">&lt;%= config.author || config.title %&gt;</span><span class=\"tag\">&lt;<span class=\"title\">br</span>&gt;</span></div><div class=\"line\">      Powered by <span class=\"tag\">&lt;<span class=\"title\">a</span> <span class=\"attribute\">href</span>=<span class=\"value\">\"http://hexo.io/\"</span> <span class=\"attribute\">target</span>=<span class=\"value\">\"_blank\"</span>&gt;</span>Hexo<span class=\"tag\">&lt;/<span class=\"title\">a</span>&gt;</span></div><div class=\"line\">      .</div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"title\">font</span> <span class=\"attribute\">id</span>=<span class=\"value\">\"sum_counter\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">font</span>&gt;</span></div><div class=\"line\">      <span class=\"tag\">&lt;<span class=\"title\">font</span> <span class=\"attribute\">id</span>=<span class=\"value\">\"detail_counter\"</span>&gt;</span><span class=\"tag\">&lt;/<span class=\"title\">font</span>&gt;</span></div><div class=\"line\">    <span class=\"tag\">&lt;/<span class=\"title\">div</span>&gt;</span></div><div class=\"line\">  <span class=\"tag\">&lt;/<span class=\"title\">div</span>&gt;</span></div><div class=\"line\"><span class=\"tag\">&lt;/<span class=\"title\">footer</span>&gt;</span></div></pre></td></tr></table></figure>\n\n<p>首先new出自己的Firebase</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"keyword\">var</span> io10blogFirebase = <span class=\"keyword\">new</span> Firebase(<span class=\"string\">\"https://io10.firebaseio.com/\"</span>);</div></pre></td></tr></table></figure>\n\n<p>然后获取访问总量以及明细</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div><div class=\"line\">9</div><div class=\"line\">10</div><div class=\"line\">11</div><div class=\"line\">12</div><div class=\"line\">13</div><div class=\"line\">14</div><div class=\"line\">15</div><div class=\"line\">16</div><div class=\"line\">17</div><div class=\"line\">18</div><div class=\"line\">19</div><div class=\"line\">20</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 明细由当前页面的url表示，将反斜线替换成下划线，并将中文decode出来</span></div><div class=\"line\"><span class=\"keyword\">var</span> current_url = <span class=\"built_in\">decodeURI</span>(<span class=\"built_in\">window</span>.location.pathname.replace(<span class=\"keyword\">new</span> <span class=\"built_in\">RegExp</span>(<span class=\"string\">'\\\\/|\\\\.'</span>, <span class=\"string\">'g'</span>),<span class=\"string\">\"_\"</span>));</div><div class=\"line\"><span class=\"comment\">// 获取总数，并将总访问量展示在页面上</span></div><div class=\"line\">io10blogFirebase.child(<span class=\"string\">\"sum\"</span>).on(<span class=\"string\">\"value\"</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span> </span>{</div><div class=\"line\">  <span class=\"keyword\">var</span> current_counter = data.val();</div><div class=\"line\">  <span class=\"keyword\">if</span>( $(<span class=\"string\">\"#sum_counter\"</span>).length &gt; <span class=\"number\">0</span>  && current_counter &gt;<span class=\"number\">1</span> ){</div><div class=\"line\">      $(<span class=\"string\">\"#sum_counter\"</span>).html(</div><div class=\"line\">   \t   \t<span class=\"string\">\"&nbsp;|&nbsp;总访问量&nbsp;&lt;font style='color:white'&gt;\"</span>+ current_counter +<span class=\"string\">\"&lt;/font&gt;&nbsp;次\"</span></div><div class=\"line\">       );</div><div class=\"line\">  };</div><div class=\"line\">});</div><div class=\"line\"><span class=\"comment\">// 获取明细，并将明细也展示在页面上</span></div><div class=\"line\">io10blogFirebase.child(<span class=\"string\">\"detail/\"</span>+current_url).on(<span class=\"string\">\"value\"</span>, <span class=\"function\"><span class=\"keyword\">function</span><span class=\"params\">(data)</span></span>{</div><div class=\"line\">\t<span class=\"keyword\">var</span> detail_counter = data.val();</div><div class=\"line\">\t<span class=\"keyword\">if</span>($(<span class=\"string\">\"#detail_counter\"</span>).length &gt; <span class=\"number\">0</span> && detail_counter &gt; <span class=\"number\">1</span>){</div><div class=\"line\">\t\t$(<span class=\"string\">\"#detail_counter\"</span>).html(</div><div class=\"line\">\t\t\t<span class=\"string\">\"&nbsp;本页访问量&nbsp;&lt;font style='color:white'&gt;\"</span>+ detail_counter +<span class=\"string\">\"&lt;/font&gt;&nbsp;次\"</span></div><div class=\"line\">\t\t);</div><div class=\"line\">\t}</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>将访问数+1，包括总数和明细</p>\n<figure class=\"highlight javascript\"><table><tr><td class=\"gutter\"><pre><div class=\"line\">1</div><div class=\"line\">2</div><div class=\"line\">3</div><div class=\"line\">4</div><div class=\"line\">5</div><div class=\"line\">6</div><div class=\"line\">7</div><div class=\"line\">8</div></pre></td><td class=\"code\"><pre><div class=\"line\"><span class=\"comment\">// 总数+1</span></div><div class=\"line\">io10blogFirebase.child(<span class=\"string\">\"sum\"</span>).transaction(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">(current_counter)</span> </span>{</div><div class=\"line\">  <span class=\"keyword\">return</span> (current_counter || <span class=\"number\">0</span>) + <span class=\"number\">1</span>;</div><div class=\"line\">});</div><div class=\"line\"><span class=\"comment\">// 明细+1</span></div><div class=\"line\">io10blogFirebase.child(<span class=\"string\">\"detail/\"</span>+current_url).transaction(<span class=\"function\"><span class=\"keyword\">function</span> <span class=\"params\">(current_counter)</span> </span>{</div><div class=\"line\">  <span class=\"keyword\">return</span> (current_counter || <span class=\"number\">0</span>) + <span class=\"number\">1</span>;</div><div class=\"line\">});</div></pre></td></tr></table></figure>\n\n<p>下面这幅图是Firebase的应用管理界面，这个界面的数也是实时在变化的。</p>\n<p><img src=\"http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/FirebaseDash.PNG\" alt=\"DashBoard\"></p>\n<p>这样，实时访问统计就可以实现啦！这里只是打开了一个思路，Firebase等于给静态网站添加上了可以实时存储于读取数据的翅膀。除了统计访问量，它能做的事情很多很多。甚至替换掉多说，自己实现一个评论系统都是有可能的！</p>\n","source":"_posts/realtime-count-firebase.md","raw":"title: 基于Firebase的Hexo博客实时访问数统计\ndate: 2015-02-27 15:12:06\ntags: [技术,firebase,hexo]\nphotos:\n- http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/firebase.PNG\n---\n\n本来想写一个HEXO的搭建过程的，但是在搜索引擎上一搜一大把教程。看到有人评论：“你写这个跟HEXO官方的教程比好在哪？”仔细想想，说的极好。索性也就不写这个人家已经写烂了的东西了。附一个[官方教程链接](http://hexo.io/docs/)。其实在搭建过程中还参考了一个很全面很详细的博客，也附上链接吧，[ibruce不如](http://ibruce.info/2013/11/22/hexo-your-blog/)。\n对于像HEXO这种静态博客来讲，想要做到一些动态的功能就必须得靠第三方支持，比如评论可以使用多说、Disqus。虽然我的blog的访问人数少的可怜，但是我还是希望知道有多少访问量的。于是乎发现了FireBase这个神奇的东西，它是一个制作实时应用的框架，用它来统计访问量绰绰有余啦。它可以做到的就像本博客下面的一样，你可以尝试开启两个本博客窗口，然后刷新其中一个，看看另外一个页面，是不是很神奇？另一个页面的访问量也实时增加了！\n\n<!--more-->\n\n##注册Firebase账号\n在[Firebase官网](www.firebase.com)注册一个新用户\n![Sign Up](http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/signup.PNG)\n\n##创建应用\n注册成功以后就可以创建一个应用了\n![create app](http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/createApp.PNG)\n\n##Firebase基本用法\nFirebase使用JSON存储数据，但是Firebase不支持Arrays数组，它会将数组转换成一个Object对象来存储，就像这样。\n```javascript\n['a', 'b', 'c', 'd', 'e']\n```\n会被转换成这样存储\n```javascript\n{0: 'a', 1: 'b', 2: 'c', 3: 'd', 4: 'e'}\n```\n###存储数据\n####`set()`\n`set()`方法调用若原先没有值则会新增，若原先有值，会覆盖原有的结构替换成这次的内容包括子节点！\n####`update()`\n`update()`可以更新一个已经存在的值，并且不会覆盖其他内容。\n####`transaction()`\n`transaction()`就是本文用来统计访问量的方法。支持在原有值得基础上进行修改，它的参数是一个回调函数，用来处理原有的值使其变成新的值。下面是官方给的例子，就是用来统计访问量的。\n```javascript\nvar upvotesRef = new Firebase('https://docs-examples.firebaseio.com/android/saving-data/fireblog/posts/-JRHTHaIs-jNPLXOQivY/upvotes');\nupvotesRef.transaction(function (current_value) {\n  return (current_value || 0) + 1;\n});\n```\n###读取数据\nfirebase可以绑定比如`child_added`、`Child Removed`、`value`等事件，每当有子元素添加或者值变化时会触发绑定的回调函数。具体调用方法可以参考本文后面提到的方法。\n\n##在你的HEXO页面上引入Firebase\n在页面的head中引入Firebase的js，\n```html\n<script src='https://cdn.firebase.com/js/client/2.0.4/firebase.js'></script>\n```\n为了加速，也可以将这个js放到自己的七牛云存储上。\n\n##增加代码调用Firebase来实现记录访问数\n###思路：\n1.总共记录两类访问记录，一个总数，一个该页面数\n2.该页面数使用该页面的url作为key值\n3.每次访问一个页面时，总数+1，本页面数+1\n4.同时增加记录最后更新时间，和最后更新的那个页面的url\n###过程：\n先修改页面的footer用来展示访问记录数，就像这样。当然你可以加在页面的任意位置。\n```html\n<footer id=\"footer\">\n  <% if (theme.sidebar === 'bottom'){ %>\n    <%- partial('_partial/sidebar') %>\n  <% } %>\n  <div class=\"outer\">\n    <div id=\"footer-info\" class=\"inner\">\n      &copy; <%= date(new Date(), 'YYYY') %> <%= config.author || config.title %><br>\n      Powered by <a href=\"http://hexo.io/\" target=\"_blank\">Hexo</a>\n      .\n      <font id=\"sum_counter\"></font>\n      <font id=\"detail_counter\"></font>\n    </div>\n  </div>\n</footer>\n```\n\n首先new出自己的Firebase\n```javascript\nvar io10blogFirebase = new Firebase(\"https://io10.firebaseio.com/\");\n```\n然后获取访问总量以及明细\n```javascript\n// 明细由当前页面的url表示，将反斜线替换成下划线，并将中文decode出来\nvar current_url = decodeURI(window.location.pathname.replace(new RegExp('\\\\/|\\\\.', 'g'),\"_\"));\n// 获取总数，并将总访问量展示在页面上\nio10blogFirebase.child(\"sum\").on(\"value\", function(data) {\n  var current_counter = data.val();\n  if( $(\"#sum_counter\").length > 0  && current_counter >1 ){\n      $(\"#sum_counter\").html(\n   \t   \t\"&nbsp;|&nbsp;总访问量&nbsp;<font style='color:white'>\"+ current_counter +\"</font>&nbsp;次\"\n       );\n  };\n});\n// 获取明细，并将明细也展示在页面上\nio10blogFirebase.child(\"detail/\"+current_url).on(\"value\", function(data){\n\tvar detail_counter = data.val();\n\tif($(\"#detail_counter\").length > 0 && detail_counter > 1){\n\t\t$(\"#detail_counter\").html(\n\t\t\t\"&nbsp;本页访问量&nbsp;<font style='color:white'>\"+ detail_counter +\"</font>&nbsp;次\"\n\t\t);\n\t}\n});\n```\n将访问数+1，包括总数和明细\n```javascript\n// 总数+1\nio10blogFirebase.child(\"sum\").transaction(function (current_counter) {\n  return (current_counter || 0) + 1;\n});\n// 明细+1\nio10blogFirebase.child(\"detail/\"+current_url).transaction(function (current_counter) {\n  return (current_counter || 0) + 1;\n});\n```\n下面这幅图是Firebase的应用管理界面，这个界面的数也是实时在变化的。\n\n![DashBoard](http://7vzqg8.com1.z0.glb.clouddn.com/realtime-count-firebase/FirebaseDash.PNG)\n\n这样，实时访问统计就可以实现啦！这里只是打开了一个思路，Firebase等于给静态网站添加上了可以实时存储于读取数据的翅膀。除了统计访问量，它能做的事情很多很多。甚至替换掉多说，自己实现一个评论系统都是有可能的！","slug":"realtime-count-firebase","updated":1425562446374,"excerpt":"<p>本来想写一个HEXO的搭建过程的，但是在搜索引擎上一搜一大把教程。看到有人评论：“你写这个跟HEXO官方的教程比好在哪？”仔细想想，说的极好。索性也就不写这个人家已经写烂了的东西了。附一个<a href=\"http://hexo.io/docs/\" target=\"_blank\" rel=\"external\">官方教程链接</a>。其实在搭建过程中还参考了一个很全面很详细的博客，也附上链接吧，<a href=\"http://ibruce.info/2013/11/22/hexo-your-blog/\" target=\"_blank\" rel=\"external\">ibruce不如</a>。<br>对于像HEXO这种静态博客来讲，想要做到一些动态的功能就必须得靠第三方支持，比如评论可以使用多说、Disqus。虽然我的blog的访问人数少的可怜，但是我还是希望知道有多少访问量的。于是乎发现了FireBase这个神奇的东西，它是一个制作实时应用的框架，用它来统计访问量绰绰有余啦。它可以做到的就像本博客下面的一样，你可以尝试开启两个本博客窗口，然后刷新其中一个，看看另外一个页面，是不是很神奇？另一个页面的访问量也实时增加了！</p>\n","_id":"vy7yilvb1jso5551","categories":[],"comments":true,"layout":"post","link":""},{"title":"第一篇blog","date":1424157126000,"tags":["2atqo4v87s51qitm"],"content":"<p>博客开张啦，这是我的第一篇博客，基于Hexo搭建，部署在Github Page上。</p>\n<p>地址：<a href=\"http://pangjian.info\" target=\"_blank\" rel=\"external\">pangjian.info</a></p>\n","source":"_posts/第一篇blog.md","raw":"title: 第一篇blog\ndate: 2015-02-17 15:12:06\ntags: [生活]\n---\n博客开张啦，这是我的第一篇博客，基于Hexo搭建，部署在Github Page上。\n\n地址：[pangjian.info](http://pangjian.info)","slug":"第一篇blog","updated":1425342392794,"excerpt":"","_id":"yii4zpubibi4aldj","categories":[],"comments":true,"layout":"post","photos":[],"link":""}],"Tag":[{"name":"技术","_id":"hv06o0yl1bam5qcp","posts":["vy7yilvb1jso5551"]},{"name":"firebase","_id":"cf916ew7c6afg12c","posts":["vy7yilvb1jso5551"]},{"name":"hexo","_id":"55a0ailcrihn5x6s","posts":["vy7yilvb1jso5551"]},{"name":"生活","_id":"2atqo4v87s51qitm","posts":["yii4zpubibi4aldj"]}]}